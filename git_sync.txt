for branch in $(git for-each-ref --format='%(refname:short)' refs/heads/); do {
  echo branch="$branch"
  git checkout "$branch"
  git pull origin master
  
  if output="$(git status --porcelain)" && [ -n "$output" ]; then
    echo "'git status --porcelain' had no errors AND the working directory" \
         "is dirty (has UNCOMMITTED changes)."
    # Commit the changes here
    echo "Working directory has UNCOMMITTED CHANGES."
    git reset --merge
    git add .
    git commit -m "Merge with master"
    git push origin "$branch"
    git checkout master
fi
  
}
done